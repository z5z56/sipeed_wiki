<!DOCTYPE html>
<html  class="language_zh">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="maixpy, k210, AIOT, 边缘计算">
    <meta name="description" content="maixpy doc: KPU">
    <meta name="generator" content="teedoc">
    <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        <link rel="stylesheet" href="/static/css/theme_default/prism.min.css" type="text/css"/>
        <link rel="stylesheet" href="/static/css/theme_default/viewer.min.css" type="text/css"/>
        <link rel="stylesheet" href="/static/css/theme_default/dark.css" type="text/css"/>
        <link rel="stylesheet" href="/static/css/theme_default/light.css" type="text/css"/>
        <link rel="stylesheet" href="/static/css/custom.css" type="text/css"/>
        <script src="/static/js/theme_default/split.js"></script>
        <script src="/static/js/theme_default/jquery.min.js"></script>
        <script src="/static/js/theme_default/pre_main.js"></script>
        <link rel="stylesheet" href="/static/css/search/style.css" type="text/css"/>
        <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?9cb07365544a53067c56c346c838181a";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
    <title>KPU - Sipeed Wiki</title>
</head>
<body>
    
            <div id="navbar">
                <div id="navbar_menu">
                    <a class="site_title" href="/"><img class="site_logo" src="/static/image/logo.svg" alt="sipeed wiki logo"><h2>wiki</h2></a>
                    <a id="navbar_menu_btn"></a>
                </div>
                <div id="navbar_items">
                    <div>
                        <ul id="nav_left">
<li class=""><a  href="/">首页</a></li>
<li class=""><a target="_blank" href="https://www.sipeed.com">矽速官网</a></li>
<li class="sub_items active_parent"><a >开源软件</a><ul><li class="active"><a  href="/soft/maixpy/zh/">MaixPy</a></li>
<li class=""><a  href="/soft/maixpy3/zh/">MaixPy3</a></li>
<li class=""><a  href="/soft/maixduino/zh/">MaixDuino</a></li>
<li class=""><a  href="/soft/Lichee/zh/">Lichee</a></li>
<li class=""><a  href="/soft/longan/zh/">Longan</a></li>
<li class=""><a  href="/soft/Tang/zh/index_bak.html">Tang</a></li>
</ul>
</li>
<li class="sub_items "><a >开源硬件</a><ul><li class=""><a  href="/hardware/zh/maix/index.html">Maix-I</a></li>
<li class=""><a  href="/hardware/zh/maixII/index.html">Maix-II</a></li>
<li class=""><a  href="/hardware/zh/maixIII/index.html">Maix-III</a></li>
<li class=""><a  href="/hardware/zh/maixIV/index.html">Maix-IV</a></li>
<li class=""><a  href="/hardware/zh/lichee/index.html">Lichee Pi</a></li>
<li class=""><a  href="/hardware/zh/tang/index.html">Tang</a></li>
<li class=""><a  href="/hardware/zh/longan/index.html">Longan</a></li>
</ul>
</li>
<li class="sub_items "><a >商业产品</a><ul><li class=""><a  href="/hardware/maixface/zh/">Maix Face</a></li>
</ul>
</li>
<li class="sub_items "><a >云平台</a><ul><li class=""><a target="_blank" href="https://www.maixhub.com">Maixhub 模型训练平台</a></li>
<li class=""><a target="_blank" href="https://www.maixhub.com/onlinecompiler">固件在线编译</a></li>
</ul>
</li>
<li class=""><a  href="/community.html">社区</a></li>
<li class=""><a  href="/store.html">商城</a></li>
</ul>

                    </div>
                    <div>
                        <ul id="nav_right">
<li class="sub_items "><a  href="">Language: 中文</a><ul><li class="active"><a  href="/soft/maixpy/zh/">中文</a></li>
<li class=""><a  href="/soft/maixpy/en/">English</a></li>
</ul></li>
</ul>

                        <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">搜索</span>
                            <div id="search_hints">
                                <span id="search_input_hint">输入关键词，多关键词空格隔开</span>
                                <span id="search_loading_hint">正在加载，请稍候。。。</span>
                                <span id="search_download_err_hint">下载文件失败，请刷新重试或检查网络</span>
                                <span id="search_other_docs_result_hint">来自其它文档的结果</span>
                                <span id="search_curr_doc_result_hint">当前文档搜索结果</span>
                            </div></a></li></ul>
                    </div>
                </div>
            </div>
    
        <div id="wrapper">
            
            <div id="sidebar_wrapper">
                <div id="sidebar">
                    <div id="sidebar_title">
                        
                    </div>
                    <ul class="show">
<li class="not_active with_link"><a href="/soft/maixpy/zh/index.html"><span class="label">简介</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/what_maix_do.html"><span class="label">MaixPy 能做哪些事</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/maixpy_history.html"><span class="label">MaixPy 发展历程</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/thanks.html"><span class="label">致谢</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">入门指南</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/how_to_read.html"><span class="label">如何正确阅读本文 (重要！！！)</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/how_to_ask.html"><span class="label">如何优雅提问 (重要！！！)</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">开发板和配件选购指南</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/get_hardware.html"><span class="label">开发板选购指南(对比)</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">开发板介绍</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_dock.html"><span class="label">Maix Dock</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_bit.html"><span class="label">Maix Bit</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_amigo.html"><span class="label">Maix Amigo</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_duino.html"><span class="label">Maix Duino</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_cube.html"><span class="label">Maix Cube</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_go.html"><span class="label">Maix Go</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/maix_nano.html"><span class="label">Maix Nano</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/grove_ai_hat.html"><span class="label">Grove AI HAT</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">外设模组（配件）</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/index.html"><span class="label">SP-MOD</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/grove/index.html"><span class="label">Grove</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/index.html"><span class="label">其它</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">开发环境准备</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/env_install_driver.html"><span class="label">安装驱动</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/dock.html"><span class="label">Maix Dock</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/bit.html"><span class="label">Maix Bit</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/amigo.html"><span class="label">Maix Amigo</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/cube.html"><span class="label">Maix Cube</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/go.html"><span class="label">Maix Go</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/nano.html"><span class="label">Maix Nano</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/ai_hat.html"><span class="label">Grove AI HAT</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/install_driver/duino.html"><span class="label">Maix Duino</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/upgrade_maixpy_firmware.html"><span class="label">更新 MaixPy 固件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/env_serial_tools.html"><span class="label">串口终端工具</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/mpfshell-lite/mpfshell-lite.html"><span class="label">mpfshell-lite工具介绍</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/mpfshell-lite/mpfshell-lite-help.html"><span class="label">Mpfshell-lite 使用手册</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/env_maixpyide.html"><span class="label">MaixPy IDE 使用说明</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">更新 WIFI 模块固件</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/upgrade_esp32_firmware.html"><span class="label">更新板载 ESP32 固件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/upgrade_esp8285_firmware.html"><span class="label">更新板载 ESP8285 固件</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">上手</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_power_on.html"><span class="label">上电</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_cam_lcd.html"><span class="label">第一个程序: 使用屏幕和摄像头</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_led_blink.html"><span class="label">第二个程序: 点亮 LED</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">基础知识</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/knowledge_micropython.html"><span class="label">MaixPy 语法基础知识</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/knowledge_git_github.html"><span class="label">git 和 github</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/knowledge_image.html"><span class="label">MaixPy 图像基础知识</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/knowledge_audio.html"><span class="label">MaixPy 音频基础知识</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_fs.html"><span class="label">存储系统简介</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_edit_file.html"><span class="label">编辑并运行脚本</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_upload_script.html"><span class="label">上传脚本到开发板</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/get_started_boot.html"><span class="label">开机自动运行脚本</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/board_info.html"><span class="label">开发板配置文件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/get_started/maixpy_get_started_video.html"><span class="label">上手视频教程</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">固件定制</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/firmware/why_customize_firware.html"><span class="label">为什么需要定制固件</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/firmware/online_compile.html"><span class="label">在线编译</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/firmware/compile.html"><span class="label">源码编译</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">进阶教程</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/index.html"><span class="label">教程说明</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">基本图像处理</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">图像获取和显示</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/basic/get_images.html"><span class="label">图像获取</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/basic/display_images.html"><span class="label">图像显示</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/basic/vary.html"><span class="label">MaixPy 图像及常用操作</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/basic/draw.html"><span class="label">基本画图、写字</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/basic/acc_image_deal.html"><span class="label">硬件加速的图像处理</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">MaixPy AI</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/basic/dnn_basic.html"><span class="label">深度神经网络基础知识</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/basic/maixpy_hardware_ai_basic.html"><span class="label">MaixPy AI 硬件加速基础知识</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">图像处理</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/image/face_detect.html"><span class="label">人脸检测</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/image/1000_type_classifier.html"><span class="label">1000 种物体分类</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/image/face_recognization.html"><span class="label">人脸识别</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/image/self_learn_classifier.html"><span class="label">自学习分类</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">音频处理</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/speech/recognizer_cnn.html"><span class="label">语音识别</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">模型训练</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">训练自己的分类和检测模型</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/train/maixhub.html"><span class="label">MaixHub 云端训练</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/ai/train/local.html"><span class="label">本地训练</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">传统算法</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">图像处理</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/find_color_blob.html"><span class="label">寻找色块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/find_qrcodes.html"><span class="label">二维码识别</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">音频处理</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/speech/fft.html"><span class="label">FFT</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/speech/fft_waterfall.html"><span class="label">FFT 瀑布图</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/speech/recognizer_mfcc.html"><span class="label">关键词识别</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">外设</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">片上外设</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/gpio.html"><span class="label">GPIO</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/i2c.html"><span class="label">I2C</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/pwm.html"><span class="label">PWM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/spi.html"><span class="label">SPI</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/timer.html"><span class="label">Timer</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/uart.html"><span class="label">UART</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/i2s.html"><span class="label">I2S</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/on_chip/wdt.html"><span class="label">WDT</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">SP-MOD</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_bt.html"><span class="label">BT 蓝牙透传</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_lora.html"><span class="label">LoRa 无线通信</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_rfid.html"><span class="label">RFID 射频识别</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_tof.html"><span class="label">TOF 测距</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_eink.html"><span class="label">Eink 电子墨水屏</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_lcd1.14.html"><span class="label">Lcd1.14 IPS屏</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_weather.html"><span class="label">Weather 气象模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/sp_mod/sp_ethernet.html"><span class="label">Ethernet 有线网口</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Grove</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/grove/grove_ultrasonic_ranger.html"><span class="label">Ultrasonic Ranger 测距</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/grove/grove_chainable_rgb_led.html"><span class="label">Chainable RGB LED 灯</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/grove/grove_rgb_led_ring.html"><span class="label">RGB LED Ring 灯条</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">更多外设</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/develop_kit_board/module_microphone.html"><span class="label">Sipeed 麦克风阵列</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/binocular_camera.html"><span class="label">双摄模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/mlx90640.html"><span class="label">MLX90640 串口红外镜头</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/servo.html"><span class="label">舵机</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/esp32_read_adc.html"><span class="label">ESP32 ADC</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/modules/others/onewire.html"><span class="label">onwire 单总线</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">更多功能</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">系统</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/others/system.html"><span class="label">主频、复位等</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/others/mem.html"><span class="label">内存配置与查看</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">GUI</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/image/image_draw_font/image_draw_font.html"><span class="label">中文等多国语言支持</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/others/maixui.html"><span class="label">Maix UI</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/others/lvgl.html"><span class="label">Lvgl</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/others/pye.html"><span class="label">编辑器 pye</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">网络</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/network/network_config.html"><span class="label">配置 network 网卡</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/network/socket_usage.html"><span class="label">使用 socket 通信</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">多媒体</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/media/audio.html"><span class="label">audio</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/media/video.html"><span class="label">video</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">游戏</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/media/nes.html"><span class="label">NES 游戏机</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">API手册</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/index.html"><span class="label">标准库</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/cmath.html"><span class="label">cmath</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/gc.html"><span class="label">gc</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/math.html"><span class="label">math</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/sys.html"><span class="label">sys</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/ubinascii.html"><span class="label">ubinascii</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/ucollections.html"><span class="label">ucollections</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uctypes.html"><span class="label">uctypes</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uerrno.html"><span class="label">uerrno</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uhashlib.html"><span class="label">uhashlib</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uheapq.html"><span class="label">uheapq</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/ujson.html"><span class="label">ujson</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uos.html"><span class="label">uos</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/ure.html"><span class="label">ure</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/usocket.html"><span class="label">usocket</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/ustruct.html"><span class="label">ustruct</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/utime.html"><span class="label">utime</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/standard/uzlib.html"><span class="label">uzlib</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/index.html"><span class="label">machine</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/i2c.html"><span class="label">I2C</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/pwm.html"><span class="label">PWM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/spi.html"><span class="label">SPI</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/timer.html"><span class="label">Timer</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/uart.html"><span class="label">UART</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/network.html"><span class="label">network</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine/wdt.html"><span class="label">WDT</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">Maix</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/fpioa.html"><span class="label">FPIOA</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/gpio.html"><span class="label">GPIO</span><span class=""></span></a></li>
<li class="active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/kpu.html"><span class="label">KPU</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/fft.html"><span class="label">FFT</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/i2s.html"><span class="label">I2S</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/freq.html"><span class="label">freq</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/Maix/utils.html"><span class="label">utils</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/builtin_py/index.html"><span class="label">helper</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/builtin_py/fm.html"><span class="label">fpioa_manager</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/builtin_py/board_info.html"><span class="label">board_info</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/builtin_py/pye.html"><span class="label">Micropython Editor</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/index.html"><span class="label">media</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/lcd.html"><span class="label">lcd</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/sensor.html"><span class="label">sensor</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/image/image.html"><span class="label">image</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/media/video.html"><span class="label">video</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/media/audio.html"><span class="label">audio</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/media/nes.html"><span class="label">nes</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/isolated_word.html"><span class="label">isolated_word</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/machine_vision/maix_asr.html"><span class="label">maix_asr</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/index.html"><span class="label">extend</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/touchscreen.html"><span class="label">touchscreen</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/ultrasonic.html"><span class="label">modules.ultrasonic</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/ws2812.html"><span class="label">modules.ws2812</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/htpa.html"><span class="label">modules.htpa</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/api_reference/extend/onewire.html"><span class="label">modules.onewire</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">常见问题 FAQ</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/others/maixpy_faq.html"><span class="label">MaixPy 常见问题 FAQ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/others/maixhub_faq.html"><span class="label">MaixHub 平台 FAQ</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">开发与贡献</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active no_link"><a><span class="label">开发</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/advance/project_framework.html"><span class="label">源码目录结构</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/advance/compile.html"><span class="label">如何编译 MaixPy 工程</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/advance/add_c_module.html"><span class="label">如何用 C 添加一个 MaixPy 模块</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/course/advance/pack_fs.html"><span class="label">打包文件系统</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">贡献</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/contribute/doc_convention.html"><span class="label">参与文档编写（规范）</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/contribute/code_convention.html"><span class="label">代码编写规范</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">社区 & 分享</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/share/recommend_articles.html"><span class="label">精选文章</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/soft/maixpy/zh/share/open_projects.html"><span class="label">开源项目</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">大家的经验分享</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/soft/maixpy/zh/share/my_share/index.html"><span class="label">参与经验分享/分享模板</span><span class=""></span></a></li>
</ul>
</li>
</ul>
</li>
</ul>

                </div>
                <div id="sidebar_splitter">
                </div>
            </div>
            <div id="article">
                <div id="menu_wrapper">
                                    <div id="menu">
                                    </div>
                                </div>
                <div id="content_wrapper">
                    <div id="content_body">
                        <div id="article_head">
                            <div id="article_title">
                                <h1>KPU</h1>
                            </div>
                            <div id="article_tags">
                                <ul></ul>
                            </div>
                            <div id="article_info">
                            <div>
                                <span class="article_author"></span><span class="article_date"></span>
                            </div>
                            <div>
                                <div id="source_link"><a href="https://github.com/sipeed/sipeed_wiki/blob/main/docs/soft/maixpy/zh/api_reference/Maix/kpu.md" target="_blank">编辑本页</a></div>
                            </div>
                            </div>
                        </div>
                        <div id="article_content">
                            <p>KPU是通用的神经网络处理器，它可以在低功耗的情况下实现卷积神经网络计算，时时获取被检测目标的大小、坐标和种类，对人脸或者物体进行检测和分类。</p>

<ul>
<li>KPU 具备以下几个特点：<br />
<ul><br />
<li>支持主流训练框架按照特定限制规则训练出来的定点化模型</li><br />
<li>对网络层数无直接限制，支持每层卷积神经网络参数单独配置，包括输入输出通道数目、输入输 出行宽列高</li><br />
<li>支持两种卷积内核 1x1 和 3x3</li><br />
<li>支持任意形式的激活函数</li><br />
<li>实时工作时最大支持神经网络参数大小为 5.5MiB 到 5.9MiB</li><br />
<li>非实时工作时最大支持网络参数大小为（Flash 容量-软件体积）</li><br />
</ul></li>
</ul>

<h2 id="-1">例程</h2>

<h3 id="-2">运行人脸检测</h3>

<p>模型下载地址：<a href="http://dl.sipeed.com/MAIX/MaixPy/model">http://dl.sipeed.com/MAIX/MaixPy/model</a> , 下载<code>face_model_at_0x300000.kfpkg</code></p>

<p>完整例程： <a href="https://github.com/sipeed/MaixPy_scripts/tree/master/machine_vision/face_find">face_find</a></p>

<h3 id="-3">运行特征图</h3>

<p>模型下载地址：<a href="http://dl.sipeed.com/MAIX/MaixPy/model">http://dl.sipeed.com/MAIX/MaixPy/model</a> , 下载<code>face_model_at_0x300000.kfpkg</code></p>

<p>该模型是8bit定点模型，约380KB大小，层信息为：</p>

<pre><code>1 2        :160x120
3 4 5 6    :80x60
7 8 9 10   :40x30
11~16      :20x15
</code></pre>

<pre><code class="python language-python">import sensor
import image
import lcd
import KPU as kpu
index=3  
lcd.init()
sensor.reset()
sensor.set_pixformat(sensor.RGB565)
sensor.set_framesize(sensor.QVGA)
sensor.run(1)
task=kpu.load(0x300000)
img=image.Image()
info=kpu.netinfo(task)
layer=info[index]
w=layer.wo()
h=layer.ho()
num=int(320*240/w/h)
list=[None]*num
x_step=int(320/w)
y_step=int(240/h)
img_lcd=image.Image()
while True:
    img=sensor.snapshot()
    fmap=kpu.forward(task,img,index)
    for i in range(0,num):
        list[i]=kpu.fmap(fmap,i)
    for i in range(0,num):
        list[i].stretch(64,255)
    for i in range(0,num):
        a=img_lcd.draw_image(list[i],((i%x_step)*w,(int(i/x_step))*h))
       lcd.display(img_lcd)
    kpu.fmap_free(fmap)
</code></pre>

<hr />

<h2 id="-4">模块方法</h2>

<h3 id="load">load</h3>

<p>从flash或者文件系统中加载模型</p>

<pre><code class="python language-python">KPU.load(offset, file_path)
</code></pre>

<h4 id="-5">参数</h4>

<p><code>offset</code> 和 <code>file_path</code> 参数只能二选一，不需要关键词，直接传参即可</p>

<ul>
<li><code>offset</code>: 模型在 flash 中的偏移大小，如 <code>0xd00000</code> 表示模型烧录在13M起始的地方, <code>0x300000</code>表示在 <code>Flash</code> <code>3M</code>的地方</li>
<li><code>file_path</code>: 模型在文件系统中为文件名， 如 <code>“/sd/xxx.kmodel”</code></li>
</ul>

<h5 id="-6">返回</h5>

<p>如果正确加载，会返回返回值， 否则会抛出错误， 请看抛出的错误提示， 另外错误代码参考<a href="https://github.com/sipeed/MaixPy/blob/fa3cf2c96353fa698e9386e42be8b3c9cf495114/components/kendryte_sdk/include/sipeed_kpu.h#L6-L23">这里</a></p>

<p>如果发现错误代码是小于 <code>2000</code> 的值， 则是固件版本太低，需要更新固件版本</p>

<ul>
<li><code>kpu_net</code>: kpu 网络对象</li>
</ul>

<h3 id="load_flash">load_flash</h3>

<p>与 load 方法作用相同，</p>

<pre><code class="python language-python">kpu.load_flash(model_addr, is_dual_buf, batch_size, spi_speed)
</code></pre>

<h4 id="-7">参数</h4>

<ul>
<li><code>model_addr</code>：Flash addr 经过预处理的模型烧录到 flash 中的偏移地址。注意，这里需要预处理模型文件<a href="https://github.com/sipeed/MaixPy_scripts/blob/master/machine_vision/load_big_model/README_ZH.md">说明</a>。</li>
<li><code>is_dual_buf</code>：<code>0</code>,单一缓冲区加载，使用较少的 RAM 和较慢的速度动态加载该模型文件； <code>1</code>，开启双缓冲加载，需要更大的 RAM， 运行速度相对较快。</li>
<li><code>batch_size</code>：将 <code>is_dual_buf</code> 设置为 1 时，需要设置 load batch_size，建议值为 <code>0x4000~0x10000</code>，可以测试出模型的最佳值。如果 <code>is_dual_buf</code> 为 0 则设置为 0</li>
<li><code>spi_speed</code>：使用 SPI flash 加载模型文件时，我们会暂时将 flash 设置为高速模式，并设置所需的 spi 时钟频率。该值应 &lt;= 80000000(实际频率，设值可能不等于实际频率。)</li>
</ul>

<h4 id="-8">返回值</h4>

<ul>
<li><code>kpu_net</code>: kpu 网络对象</li>
</ul>

<h3 id="init_yolo2">init_yolo2</h3>

<p>为<code>yolo2</code>网络模型传入初始化参数， 只有使用<code>yolo2</code>时使用</p>

<pre><code class="python language-python">KPU.init_yolo2(kpu_net, threshold, nms_value, anchor_num, anchor)
</code></pre>

<p>比如：</p>

<pre><code class="python language-python">import KPU as kpu
task = kpu.load(0x300000)
anchor = (1.889, 2.5245, 2.9465, 3.94056, 3.99987, 5.3658, 5.155437, 6.92275, 6.718375, 9.01025)
kpu.init_yolo2(task, 0.5, 0.3, 5, anchor)
</code></pre>

<h4 id="-9">参数</h4>

<ul>
<li><code>kpu_net</code>: kpu 网络对象, 即加载的模型对象, <code>KPU.load()</code>的返回值</li>
<li><code>threshold</code>: 概率阈值， 只有是这个物体的概率大于这个值才会输出结果， 取值范围：[0, 1]</li>
<li><code>nms_value</code>: box_iou 门限, 为了防止同一个物体被框出多个框，当在同一个物体上框出了两个框，这两个框的交叉区域占两个框总占用面积的比例 如果小于这个值时， 就取其中概率最大的一个框</li>
<li><code>anchor_num</code>: anchor 的锚点数， 这里固定为 <code>len(anchors)//2</code></li>
<li><code>anchor</code>: 锚点参数与模型参数一致，同一个模型这个参数是固定的，和模型绑定的（训练模型时即确定了）， 不能改成其它值。</li>
</ul>

<h4 id="-10">返回值</h4>

<ul>
<li><code>success</code>： <code>bool</code>类型， 是否成功</li>
</ul>

<h3 id="deinit">deinit</h3>

<p>释放模型占用的内存， 立即释放， 但是变量还在，可以使用<code>del kpu_net_object</code> 的方式删除，<br />
另外也可以直接只使用<code>del kpu_net_object</code>来标记对象已被删除，下一次<code>GC</code>进行内存回收或者手动调用<code>gc.collect()</code>时，会自动释放内存</p>

<pre><code class="python language-python">KPU.deinit(kpu_net)
</code></pre>

<p>比如：</p>

<pre><code class="python language-python">import KPU as kpu
import gc
task = kpu.load(0x300000)
kpu.deinit(task)
del task
gc.collect()
</code></pre>

<p>或者：</p>

<pre><code class="python language-python">import KPU as kpu
import gc
task = kpu.load(0x300000)
del task
gc.collect()
</code></pre>

<h4 id="-11">参数</h4>

<p><code>kpu_net</code>: <code>KPU.load()</code> 返回的 <code>kpu_net</code> 对象</p>

<h4 id="-12">返回值</h4>

<ul>
<li><code>success</code>： <code>bool</code> 类型， 是否成功</li>
</ul>

<h3 id="run_yolo2">run_yolo2</h3>

<pre><code class="python language-python">import KPU as kpu
import image
task = kpu.load(offset or file_path)
anchor = (1.889, 2.5245, 2.9465, 3.94056, 3.99987, 5.3658, 5.155437, 6.92275, 6.718375, 9.01025)
kpu.init_yolo2(task, 0.5, 0.3, 5, anchor)
img = image.Image()
kpu.run_yolo2(task, img) 
</code></pre>

<blockquote>
  <p>以上为节选代码，并不是完整部分，详细请看<a href="https://github.com/sipeed/MaixPy_scripts/blob/master/machine_vision/face_find/demo_find_face.py">人脸检测</a>具体的代码</p>
</blockquote>

<h4 id="-13">参数</h4>

<ul>
<li><code>kpu_net</code>: kpu_load 返回的 kpu_net 对象</li>
<li><code>image_t</code>：从 sensor 采集到的图像</li>
</ul>

<h5 id="-14">返回</h5>

<ul>
<li><code>list</code>: kpu_yolo2_find 的列表 </li>
</ul>

<h3 id="forward">forward</h3>

<p>计算已加载的网络模型到指定层数，输出目标层的特征图</p>

<pre><code class="python language-python">fmap=KPU.forward(kpu_net, img, end_layer)
</code></pre>

<pre><code class="python language-python">import KPU as kpu
task = kpu.load(offset or file_path)
……
fmap=kpu.forward(task,img, 3)
</code></pre>

<h4 id="-15">参数</h4>

<ul>
<li><code>kpu_net</code>: kpu_net 对象</li>
<li><code>img</code>: 图像 <code>image.Image</code> 对象</li>
<li><code>end_layer</code>: 指定计算到网络的第几层， 取值从<code>0</code>开始</li>
</ul>

<h5 id="-16">返回</h5>

<ul>
<li><code>fmap</code>: 特征图对象，内含当前层所有通道的特征图</li>
</ul>

<h3 id="fmap">fmap</h3>

<p>取特征图的指定通道数据到<code>image.Image</code>对象</p>

<pre><code class="python language-python">img=KPU.fmap(fmap, channel)
</code></pre>

<h4 id="-17">参数</h4>

<ul>
<li><code>fmap</code>: 特征图 对象</li>
<li><code>channel</code>: 指定特征图的通道号, 从<code>0</code>开始</li>
</ul>

<h5 id="-18">返回</h5>

<ul>
<li><code>img</code>: 特征图对应通道生成的灰度图，类型<code>image.Image</code></li>
</ul>

<h3 id="fmap_free">fmap_free</h3>

<p>释放特征图对象</p>

<pre><code class="python language-python">KPU.fmap_free(fmap)
</code></pre>

<h4 id="-19">参数</h4>

<ul>
<li><code>fmap</code>: 特征图 对象</li>
</ul>

<h5 id="-20">返回</h5>

<ul>
<li>无</li>
</ul>

<h3 id="netinfo">netinfo</h3>

<p>获取模型的网络结构信息</p>

<pre><code class="python language-python">info_list = kpu.netinfo(task)
</code></pre>

<h4 id="-21">参数</h4>

<ul>
<li><code>kpu_net</code>: kpu_net 对象, <code>KPU.load()</code>返回值</li>
</ul>

<h5 id="-22">返回</h5>

<ul>
<li><code>info_list</code>：所有层的信息list, 包含信息为：<br />
<ul><br />
<li><code>index</code>：当前层在网络中的层数</li><br />
<li><code>wi</code>：输入宽度</li><br />
<li><code>hi</code>：输入高度</li><br />
<li><code>wo</code>：输出宽度</li><br />
<li><code>ho</code>：输出高度</li><br />
<li><code>chi</code>：输入通道数</li><br />
<li><code>cho</code>：输出通道数</li><br />
<li><code>dw</code>：是否为depth wise layer</li><br />
<li><code>kernel_type</code>：卷积核类型，0为1x1， 1为3x3</li><br />
<li><code>pool_type</code>：池化类型，0不池化; 1：2x2 max pooling; 2:...</li><br />
<li><code>para_size</code>：当前层的卷积参数字节数</li><br />
</ul></li>
</ul>

<h3 id="set_outputs">set_outputs</h3>

<pre><code class="python language-python">success = set_outputs(kput_net, out_idx, width, height, channel)
</code></pre>

<p>手动设置输出层形状， 对于 nncase v0.2.0 转换出来的 V4 的 kmodel 模型，<br />
在 <code>load</code> 之后需要调用此函数手动设置输出层形状， V3 模型不需要</p>

<h4 id="-23">参数</h4>

<ul>
<li><code>kpu_net</code>: kpu_net 对象</li>
<li><code>out_idx</code>: 输出层下表， 从 <code>0</code> 开始， 比如第一层输出层是<code>0</code></li>
<li><code>width</code>： 层宽度， 如果是一维输出，则为<code>1</code></li>
<li><code>height</code>: 层高度， 如果是一维输出，则为<code>1</code></li>
<li><code>channnel</code>： 层通道数，如果是一维输出，则这里为一维输出的长度</li>
</ul>

<h5 id="-24">返回</h5>

<ul>
<li><code>success</code>： 是否设置成功， 如果不成功，注意看输出的提示信息， 参考<a href="https://github.com/sipeed/MaixPy/blob/fa3cf2c96353fa698e9386e42be8b3c9cf495114/components/kendryte_sdk/include/sipeed_kpu.h#L6-L23">错误代码</a></li>
</ul>

<h3 id="memtest">memtest</h3>

<p>打印内存使用情况，包括<code>GC</code>内存和系统堆内存</p>

<ul>
<li>注意执行这个函数会自动先执行<code>gc.collect()</code>进行内存回收一次，再打印<code>GC</code>剩余内存</li>
<li>系统堆内存只做参考，不一定准确，有时可能出现已经释放了内存，但是显示依然没有释放，以实际能不能分配到内存为准</li>
</ul>

<pre><code class="python language-python">KPU.memtest()
</code></pre>

<h3 id="face_encode">face_encode</h3>

<p>将 <code>forward</code> 返回的特征图进行量化，更多详情请查看：<a href="https://github.com/sipeed/MaixPy/issues/342">kpu issue</a></p>

<pre><code class="python language-python">feature = kpu.face_encode(fmap[:])
</code></pre>

<h4 id="-25">参数</h4>

<p><code>fmap[:]</code>：<code>list</code> 类型，将 <code>forward</code> 函数返回值转化为列表所得到的</p>

<h4 id="-26">返回值</h4>

<p><code>feature</code>：<code>list</code> 类型，量化后的列表</p>

<h3 id="face_compare">face_compare</h3>

<p>将 face_encode 返回的量化值与已录入的人脸进行比较</p>

<pre><code class="python language-python">score = kpu.face_compare(record_ftrs[j], feature)
</code></pre>

<h4 id="-27">参数</h4>

<p><code>record_ftrs[j]</code>：<code>list</code> 类型，以录入的人脸数据<br />
<code>feature</code>：<code>list</code> 类型，需要比较的人脸数据， <code>face_encode</code> 的返回值</p>

<h4 id="-28">返回值</h4>

<p><code>score</code>：<code>int</code> 类型，比较得分（0~100），得分越高相似度越大</p>

                        </div>
                    </div>
                    <div id="previous_next">
                        <div id="previous">
                            <a href="/soft/maixpy/zh/api_reference/Maix/gpio.html"><span class="icon"></span><span class="label">GPIO</span></a>
                        </div>
                        <div id="next">
                            <a href="/soft/maixpy/zh/api_reference/Maix/fft.html"><span class="label">FFT</span><span class="icon"></span></a>
                        </div>
                    </div>
                </div>
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
        <a id="to_top" href="#"></a>
        <div id="doc_footer">
                        
            <div id="footer">
                <div id="footer_top">
                    <ul>
<li><a>链接</a><ul><li><a target="_blank" href="https://www.sipeed.com">Sipeed</a></li>
<li><a target="_blank" href="https://bbs.sipeed.com/">BBS 论坛</a></li>
<li><a target="_blank" href="https://maixhub.sipeed.com/">Maixhub</a></li>
<li><a target="_blank" href="https://sipeed.taobao.com/">Sipeed 淘宝</a></li>
<li><a target="_blank" href="https://github.com/neutree/teedoc">网站使用 teedoc 生成</a></li>
</ul>
</li>
<li><a>网站统计</a><ul><li><a target="_blank" href="https://tongji.baidu.com/web/welcome/ico?s=9cb07365544a53067c56c346c838181a">百度统计</a></li>
<li><a  href="/sitemap.xml">网站地图</a></li>
</ul>
</li>
<li><a>源码</a><ul><li><a target="_blank" href="https://github.com/sipeed/sipeed_wiki">文档源文件</a></li>
<li><a target="_blank" href="https://github.com/sipeed">开源项目源码</a></li>
</ul>
</li>
<li><a>关注我们</a><ul><li><a target="_blank" href="https://github.com/sipeed">github</a></li>
<li><a target="_blank" href="https://twitter.com/SipeedIO">twitter</a></li>
<li><a target="_blank" href="https://sipeed.taobao.com/">淘宝</a></li>
<li><a  href="/community.html">更多</a></li>
</ul>
</li>
<li><a>联系我们</a><ul><li><a>电话: +86 0755-27808509</a>
</li>
<li><a>商业支持: support@sipeed.com</a>
</li>
<li><a>地址: 深圳市宝安区新湖路4008号蘅芳科技办公大厦A座-2101C</a>
</li>
<li><a  href="/join_us.html">加入我们</a></li>
</ul>
</li>
</ul>

                </div>
                <div id="footer_bottom">
                    <ul>
<li><a target="_blank" href="https://www.sipeed.com">©2018-2021 深圳矽速科技有限公司</a></li>
<li><a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index">粤ICP备19015433号-1</a></li>
</ul>

                </div>
            </div>
                    </div>
</body>
<script src="/static/js/theme_default/tocbot.min.js"></script>
<script src="/static/js/theme_default/main.js"></script>
<script src="/static/js/theme_default/viewer.min.js"></script>
<script src="/static/css/theme_default/prism.min.js"></script>
<script src="/static/js/custom.js"></script>
<script src="/static/js/search/search_main.js"></script>
</html>
